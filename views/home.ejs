<%- include("templates/header", {headerMessage: "Welcome User" }) %>

    <!DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-
            KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
        <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <title>Home</title>
        <script>
            require("./utils.js");

            const url = require('url');

            require('dotenv').config();
            const express = require('express');
            const session = require('express-session');
            const ObjectId = require('mongodb').ObjectId;
            const usersModel = require('./models/w2users');
            const MongoStore = require('connect-mongo');
            const bcrypt = require('bcrypt');
            const saltRounds = 12;
            console.log(usersModel)
            const port = process.env.PORT || 4000;

            const app = express();

            const Joi = require("joi");

            const expireTime = 1 * 60 * 60 * 1000;  //expires after 1 hour (hour * minutes * seconds * millis)

            /* secret information section */
            const mongodb_host = process.env.MONGODB_HOST;
            const mongodb_user = process.env.MONGODB_USER;
            const mongodb_password = process.env.MONGODB_PASSWORD;
            const mongodb_database = process.env.MONGODB_DATABASE;
            const mongodb_session_secret = process.env.MONGODB_SESSION_SECRET;

            console.log(mongodb_password)
            console.log(mongodb_user)
            const node_session_secret = process.env.NODE_SESSION_SECRET;
            /* END secret section */

            var { database } = include('databaseConnection');

            //select users 
            const userCollection = database.db(mongodb_database).collection('users');

            app.set('view engine', 'ejs');

            //req.body need this to parse (app.post) ex. req.body.username
            app.use(express.urlencoded({ extended: false }));

            // initially was /session, now /test in mongoURL
            var mongoStore = MongoStore.create({
                mongoUrl: `mongodb+srv://${mongodb_user}:${mongodb_password}@${mongodb_host}/test`,
                // mongoUrl: `mongodb+srv://${mongodb_user}:${mongodb_password}@${mongodb_host}/test`,
                crypto: {
                    secret: mongodb_session_secret
                }
            })

            //handles cookies. Ex. req.session.cookies. **would have to parse cookies ourselves otherwise.  
            app.use(session({
                secret: node_session_secret,
                store: mongoStore, //default is memory store 
                saveUninitialized: false,
                resave: true
            }
            ));
            <!--Partially created using ChatGPT: edited and code added by Emma Lee-->
            // Get today's date
            const currentDate = new Date();

            // Define the date condition to hide the div 
            const hideDate = collection.find({}, { projection: { mmse_notification_date: 1 } });

            function hideDiv() {
                var x = document.getElementById("notification");

                // Compare the current date with the hideDate
                if (currentDate != hideDate) {
                    x.style.display = "none";
                } else {
                    x.style.display = "flex";
                }
            }


        </script>
        <style>
            #myHeader {
                display: none;

            }

            body {
                background-image: url('home.jpg');
                background-position: center;
                height: 100vh;
            }

            html,
            body {
                margin: 0;
                padding: 0;
            }

            .card bg text-white {
                width: 100%;
                height: 100vh;
            }

            .btn1 {
                height: 80px;
                width: 80px;
                border-radius: 50%;
                border: 3px solid white;
                background-color: #778251;
            }

            .btn1 i {
                font-size: 40px;
            }

            .btn5 {
                background-color: #778251;
                /* Green */
                border: none;
                color: white;
                padding: 15px 32px;
                text-align: center;
                text-decoration: none;
                display: inline-block;
                font-size: 16px;
            }

            .pill {
                width: 100%;
            }

            .col-12 col-md-8 col-lg-6 col-xl-5 {
                color: coral;
            }

            .alert alert-danger {
                width: 50px;
                right: 0;
            }
        </style>
    </head>

    <body>
        <!--The div arrangement was found on https://mdbootstrap.com/docs/standard/extended/login/ - rest of coding completed by Emma Lee  -->
        <section class="vh-100 gradient-custom">
            <div class="container py-5 h-100">
                <div class="row d-flex justify-content-center align-items-center h-100">
                    <div class="col-12 col-md-8 col-lg-6 col-xl-5">
                        <div class="card bg text-white" style="border-radius: 1rem; background-color: white;">
                            <div class="card-body p-5 text-center">
                                <div id="notification" role="alert" style="height: 50px; background-color: #F5C2C1; color: black; align-items: right
                                        ;">Participate in our monthly&nbsp;
                                    <a href="#" class="alert-link" style="display: flex; align-items: right
                                        ;">questionnaire!</a>
                                </div>
                                <div class=" mb-md-5 mt-md-4 pb-5" style="background-color:#778251;
                height: 80%; border-radius: 25px;">
                                    <br>
                                    <h1 style="text-align: left; color: black;">&nbsp;&nbsp;&nbsp;Personal
                                        recommendation
                                        &nbsp;&nbsp;&nbsp;of
                                        the
                                        day&nbsp;&nbsp;&nbsp;&nbsp;</h1>
                                </div>
                                <div class="mb-md-5 mt-md-4 pb-5">
                                </div>
                                <div class="mb-md-5 mt-md-4 pb-5">
                                    <div class="container">
                                        <div class="row">
                                            <h1 style="text-align: left; color: black;">Activity Tracking</h1>
                                            <div class="col-sm">
                                                <button class="btn1"><i class="fa fa-bicycle" aria-hidden="true"></i>
                                                </button>
                                                <br>
                                                <h5 style="color: black;">Exercise</h5>
                                            </div>
                                            <div class="col-sm">
                                                <button class="btn1"><i class="fa fa-users"
                                                        aria-hidden="true"></i></button>
                                                <br>
                                                <h5 style="color: black;">Social</h5>
                                            </div>
                                            <div class="col-sm">
                                                <button class="btn1"><i class="fa fa-fire"
                                                        aria-hidden="true"></i></button>
                                                <br>
                                                <h5 style="color: black;">Smoking</h5>
                                            </div>
                                            <div class="col-sm">
                                                <button class="btn1"><i class="fa fa-glass"
                                                        aria-hidden="true"></i></button>
                                                <br>
                                                <h5 style="color: black;">Alcohol</h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-md-5 mt-md-4 pb-5">
                                    <div class="container">
                                        <div class="row">
                                            <div class="col-sm" style="width: 100%">
                                                <button type="button"
                                                    class="btn dark-green-background pill white-font font-lg"
                                                    style="background-color: #778251;">
                                                    <a href="/game" style="font-size: 20px; color:black;">
                                                        <h1>Daily Game</h1>
                                                    </a>
                                                </button>
                                                <br>
                                                <br>
                                                <button type="button"
                                                    class="btn dark-green-background pill white-font font-lg"
                                                    style="background-color: #778251;">
                                                    <a href="/mmse" style="font-size: 20px; color:black;">
                                                        <h1>Questionnaire</h1>
                                                    </a>
                                                </button>
                                                <br>
                                                <br>
                                                <button type="button"
                                                    class="btn dark-green-background pill white-font font-lg"
                                                    style="background-color: #778251;">
                                                    <a href="/logout" style="font-size: 20px; color:black;">
                                                        <h1>Log Out</h1>
                                                    </a>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>
                </div>
            </div>
            </div>
        </section>
    </body>

    </html>
    <%- include("templates/footer") %>